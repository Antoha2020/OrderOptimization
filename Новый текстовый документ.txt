Здравствуйте! Высылаю еще одну промежуточную версию программы, посмотрите, в правильном ли направлении движусь. Мастера вводятся в систему единоразово, так же как и в предыдущей версии программы. Далее необходимо определиться как будет происходить отрисовка маршрута передвижения мастера. Если нужно показывать полностью маршрут по улицам между точками заказов, тогда нужно нажать кнопку "Загрузка картографии". При этом маршруты передвижения мастера будут показываться по улицам, но в то же время с увеличением количества маршрутов, будет увеличиваться время на их отрисовку. Если точный маршрут не интересует, а важен только порядок обхода точек, то эту кнопку можно не нажимать, передвижение будет показываться прямыми линиями. Заказы вводятся в систему на главном окне, для этого следует выбрать дату выполнения заказа, вписать название, время начала работы (в формате ЧЧ:ММ), адрес и нажать кнопку Найти (планируется, что после этого в соответствующих полях появятся координаты точки с данным адресом, пока эта функция не работает и координаты надо внести вручную, пока адрес можно не вводить). Т.е. на данном этапе для добавления заказа нужно ввести его название, время и координаты. Далее нажимаем кнопку Добавить, заказ добавляется в систему и появляется на карте. Также данный заказ появляется в выпадающем списке нераспределенных заказов. Дальше можно добавлять еще новые заказы, они тоже будут появляться на карте и в выпадающем списке. Если заказ выбран в списке, то его маркер на карте красного цвета, если не выбран, но он не распределен - желтый, если заказ назначен мастеру он становится зеленым. Когда нужно назначить нераспределенный заказ мастеру, он выбирается из выпадающего списка и нажимается кнопка, которая соответствует мастеру, на которого назначается заказ. При этом заказ назначается данному мастеру и отрисовывается маршрут от точки старта до точки заказа, с учетом предыдущих точек заказа. Каждому мастеру соответствует свой цвет маршрута. Следует учесть, что если сначала мастеру назначили более поздний заказ, а потом более ранний, то маршрут обхода точек корректируется всоответствии с порядком обхода точек заказа по времени. Если выбран режим точного отображения маршрута, но система не может построить маршрут (например из-за того, что точка заказа находится вдалеке от дорог), тогда будет показана прямая линия. Нельзя добавлять мастеру два заказа с одинаковым временем на одну дату. Максимальное количество мастеров - 10.
Замените файл GmapTest.exe

http://api.sputnik.ru/maps/geocoder/

private double [] GetCurrentCoord(Master master, DateTime date)
        {
            double[] result = new double[2] { master.StartLat, master.StartLon };
            DateTime begin = new DateTime(2000, 1, 1, 0, 0, 0);
            DateTime end = new DateTime(2000, 1, 1, 0, 0, 0);
            foreach (Order order in master.myOrders)
            {
                if (order.DateOrder.ToShortDateString().Equals(date.ToShortDateString()))
                {
                    DateTime dt = Convert.ToDateTime(order.TimeEnd);
                    if (end.Hour * 60 + end.Minute <= dt.Hour * 60 + dt.Minute)
                    {
                        result[0] = Convert.ToDouble(order.Lat);
                        result[1] = Convert.ToDouble(order.Lon);
                        end = dt;
                        master.lastTimeEnd = dt.ToString("HH:mm");
                    }
                }
            }
            return result;
        }